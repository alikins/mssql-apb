FROM ansibleplaybookbundle/apb-base

LABEL "com.redhat.apb.spec"=\
"LS0tCnZlcnNpb246IDEuMApuYW1lOiBtc3NxbC1hcGIKZGVzY3JpcHRpb246IEFQQiB0byBkZXBs\
b3kgTWljcm9zb2Z0IFNRTCBTZXJ2ZXIgb24gTGludXggMjAxNwpiaW5kYWJsZTogdHJ1ZQphc3lu\
Yzogb3B0aW9uYWwKbWV0YWRhdGE6CiAgZGlzcGxheU5hbWU6IE1TIFNRTCBTZXJ2ZXIgb24gTGlu\
dXggKEFQQikKICBpbWFnZVVybDoKICAgIGh0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNv\
bS9hbnNpYmxlcGxheWJvb2tidW5kbGUvbXNzcWwtYXBiL21hc3Rlci9kb2NzL2ltZy9zcWwtc2Vy\
dmVyLnBuZwogIGRvY3VtZW50YXRpb25Vcmw6CiAgICBodHRwczovL2RvY3MubWljcm9zb2Z0LmNv\
bS9lbi11cy9zcWwvbGludXgvc3FsLXNlcnZlci1saW51eC1vdmVydmlldwogIGRlcGVuZGVuY2ll\
czogWydkb2NrZXIuaW8vdGNodWdoZXNpdi9tc3NxbC1zZXJ2ZXItbGludXgnXQp0YWdzOgogIC0g\
ZGF0YWJhc2UKICAtIG1zc3FsCnBsYW5zOgogIC0gbmFtZTogZXBoZW1lcmFsCiAgICBkZXNjcmlw\
dGlvbjogVGhpcyBwbGFuIGRlcGxveXMgYW4gZXBoZW1lcmFsIE1TIFNRTCBTZXJ2ZXIuCiAgICBm\
cmVlOiB0cnVlCiAgICBkZWZhdWx0OiB0cnVlCiAgICBtZXRhZGF0YToKICAgICAgZGlzcGxheU5h\
bWU6IEVwaGVtZXJhbCBpbnN0YWxsYXRpb24KICAgICAgbG9uZ0Rlc2NyaXB0aW9uOgogICAgICAg\
IFRoaXMgcGxhbiB3aWxsIGRlcGxveSBhIHN0YW5kYWxvbmUgTVMgU1FMIFNlcnZlciBvbiBMaW51\
eAogICAgICAgIHVzaW5nIGVwaGVtZXJhbCBzdG9yYWdlCiAgICBwYXJhbWV0ZXJzOgogICAgICAt\
IG5hbWU6IE1TU1FMX1BJRAogICAgICAgIHJlcXVpcmVkOiB0cnVlCiAgICAgICAgdHlwZTogZW51\
bQogICAgICAgIGVudW06IFsnRGV2ZWxvcGVyJywgJ0V2YWx1YXRpb24nXQogICAgICAgIGRlZmF1\
bHQ6IERldmVsb3BlcgogICAgICAgIHRpdGxlOiBTZXQgdGhlIFNRTCBTZXJ2ZXIgZWRpdGlvbi4K\
ICAgICAgICBkaXNwbGF5X2dyb3VwOiBNUyBTUUwgQ29uZmlnCiAgICAgIC0gbmFtZTogTVNTUUxf\
UEFTU1dPUkQKICAgICAgICByZXF1aXJlZDogdHJ1ZQogICAgICAgIGRlZmF1bHQ6ICJIZWxsbzEy\
MyEiCiAgICAgICAgcGF0dGVybjogIl4oPzooPzpbYS16XSsuKltBLVpdKy4qKFxcZHxcXFcpKy4q\
KVwKICAgICAgICAgIHwoPzpbQS1aXSsuKlthLXpdKy4qKFxcZHxcXFcpKy4qKVwKICAgICAgICAg\
IHwoPzooXFxkfFxcVykrLipbYS16XS4qW0EtWl0uKil8KD86KFxcZHxcXFcpKy4qW0EtWl0rLipb\
YS16XSsuKilcCiAgICAgICAgICB8KD86W0EtWl0rLiooXFxkfFxcVykrLipbYS16XSsuKil8KD86\
W2Etel0rLiooXFxkfFxcVykrLipbQS1aXSsuKilcCiAgICAgICAgICB8KD86XFxkKy4qXFxXKy4q\
KFtBLVpdfFthLXpdKSsuKil8KD86XFxXKy4qXFxkKy4qKFtBLVpdfFthLXpdKSsuKilcCiAgICAg\
ICAgICB8KD86KFtBLVpdfFthLXpdKSsuKlxcZCsuKlxcVysuKil8KD86KFtBLVpdfFthLXpdKSsu\
KlxcVysuKlxcZCsuKilcCiAgICAgICAgICB8KD86XFxXKy4qKFtBLVpdfFthLXpdKSsuKlxcZCsu\
Kil8KD86XFxkKy4qKFtBLVpdfFthLXpdKSsuKlxcVysuKikpJCIKICAgICAgICB0eXBlOiBzdHJp\
bmcKICAgICAgICBkaXNwbGF5X3R5cGU6IHBhc3N3b3JkCiAgICAgICAgdGl0bGU6ICJQYXNzd29y\
ZCBmb3IgdGhlIGRhdGFiYXNlIGFkbWluIChTQSkgdXNlci4iCiAgICAgICAgZGVzY3JpcHRpb246\
CiAgICAgICAgICAiVGhlIHBhc3N3b3JkIG11c3QgYmUgYXQgbGVhc3QgOCBjaGFyYWN0ZXJzIGxv\
bmcgYW5kIGNvbnRhaW4KICAgICAgICAgIGNoYXJhY3RlcnMgZnJvbSB0aHJlZSBvZiB0aGUgZm9s\
bG93aW5nIGZvdXIgc2V0czogVXBwZXJjYXNlCiAgICAgICAgICBsZXR0ZXJzLCBMb3dlcmNhc2Ug\
bGV0dGVycywgQmFzZSAxMCBkaWdpdHMsIGFuZCBTeW1ib2xzLiIKICAgICAgICBkaXNwbGF5X2dy\
b3VwOiBNUyBTUUwgQ29uZmlnCiAgICAgICAgbWluX2xlbmd0aDogOAogICAgICAgIG1heF9sZW5n\
dGg6IDEyOAogICAgICAtIG5hbWU6IE1TU1FMX0FHRU5UX0VOQUJMRUQKICAgICAgICB0aXRsZTog\
RW5hYmxlIFNRTCBTZXJ2ZXIgQWdlbnQuCiAgICAgICAgdHlwZTogYm9vbGVhbgogICAgICAgIHJl\
cXVpcmVkOiB0cnVlCiAgICAgICAgZGVmYXVsdDogZmFsc2UKICAgICAgICBkZXNjcmlwdGlvbjog\
QnkgZGVmYXVsdCwgYWdlbnQgaXMgZGlzYWJsZWQuCiAgICAgICAgZGlzcGxheV9ncm91cDogTVMg\
U1FMIENvbmZpZwogICAgICAtIG5hbWU6IE1TU1FMX0xPQ0FMX0lTCiAgICAgICAgdGl0bGU6IFVz\
ZSBleGlzdGluZyBtc3NxbC1zZXJ2ZXItbGludXggaW1hZ2VzdHJlYW0gaW4gcHJvamVjdC4KICAg\
ICAgICB0eXBlOiBib29sZWFuCiAgICAgICAgcmVxdWlyZWQ6IHRydWUKICAgICAgICBkZWZhdWx0\
OiBmYWxzZQogICAgICAgIGRpc3BsYXlfZ3JvdXA6IE1TIFNRTCBDb25maWcKICAgICAgLSBuYW1l\
OiBNU1NRTF9MQ0lECiAgICAgICAgdGl0bGU6IFNldCB0aGUgbGFuZ3VhZ2UgSUQuCiAgICAgICAg\
dHlwZTogaW50ZWdlcgogICAgICAgIHJlcXVpcmVkOiB0cnVlCiAgICAgICAgZGVmYXVsdDogMTAz\
MwogICAgICAgIGRlc2NyaXB0aW9uOiBGb3IgZXhhbXBsZSAtIDEwMzMgaXMgRW5nbGlzaCAoVVMp\
LCAxMDM2IGlzIEZyZW5jaC4KICAgICAgICBtaW5fbGVuZ3RoOiA0CiAgICAgICAgbWF4X2xlbmd0\
aDogNAogICAgICAgIGRpc3BsYXlfZ3JvdXA6IE1TIFNRTCBDb25maWcKICAgICAgLSBuYW1lOiBN\
U1NRTF9JTUFHRV9QVUxMCiAgICAgICAgdGl0bGU6ICJEZXBsb3ltZW50Q29uZmlnIEltYWdlIHB1\
bGwgcG9saWN5IgogICAgICAgIHR5cGU6IGVudW0KICAgICAgICBlbnVtOiBbJ0Fsd2F5cycsICdJ\
Zk5vdFByZXNlbnQnLCAnTmV2ZXInXQogICAgICAgIHJlcXVpcmVkOiB0cnVlCiAgICAgICAgZGVm\
YXVsdDogSWZOb3RQcmVzZW50CiAgICAgICAgZGlzcGxheV9ncm91cDogTVMgU1FMIENvbmZpZwog\
ICAgICAtIG5hbWU6IE1TU1FMX01FTU9SWV9MSU1JVAogICAgICAgIHJlcXVpcmVkOiB0cnVlCiAg\
ICAgICAgZGVmYXVsdDogMwogICAgICAgIHR5cGU6IGludGVnZXIKICAgICAgICB0aXRsZToKICAg\
ICAgICAgIE1heGltdW0gYW1vdW50IG9mIG1lbW9yeSB0aGUgY29udGFpbmVyIGNhbiB1c2UgKGlu\
IEdCKSBlZyAxR0IgMkdCCiAgICAgICAgZGlzcGxheV9ncm91cDogRW52aXJvbm1lbnQgU2l6aW5n\
CiAgICAgIC0gbmFtZTogTVNTUUxfTUVNT1JZX1JFUVVFU1QKICAgICAgICByZXF1aXJlZDogdHJ1\
ZQogICAgICAgIGRlZmF1bHQ6IDIKICAgICAgICB0eXBlOiBpbnRlZ2VyCiAgICAgICAgdGl0bGU6\
CiAgICAgICAgICBSZXF1ZXN0ZWQgYW1vdW50IG9mIG1lbW9yeSBmb3IgdGhlIGNvbnRhaW5lciB0\
byBzdGFydCAoaW4gR0IpCiAgICAgICAgICBlZyAxR0IgMkdCCiAgICAgICAgZGlzcGxheV9ncm91\
cDogRW52aXJvbm1lbnQgU2l6aW5nCgogIC0gbmFtZTogcGVyc2lzdGVudAogICAgZGVzY3JpcHRp\
b246IFRoaXMgcGxhbiBkZXBsb3lzIGEgcGVyc2lzdGVudCBNUyBTUUwgU2VydmVyLgogICAgZnJl\
ZTogdHJ1ZQogICAgbWV0YWRhdGE6CiAgICAgIGRpc3BsYXlOYW1lOiBQZXJzaXN0ZW50IGluc3Rh\
bGxhdGlvbgogICAgICBsb25nRGVzY3JpcHRpb246CiAgICAgICAgVGhpcyBwbGFuIHdpbGwgZGVw\
bG95IGEgc3RhbmRhbG9uZSBNUyBTUUwgU2VydmVyIG9uIExpbnV4CiAgICAgICAgdXNpbmcgcGVy\
c2lzdGVudCBzdG9yYWdlCiAgICBwYXJhbWV0ZXJzOgogICAgICAtIG5hbWU6IE1TU1FMX1BJRAog\
ICAgICAgIHJlcXVpcmVkOiB0cnVlCiAgICAgICAgdHlwZTogZW51bQogICAgICAgIGVudW06IFsn\
RGV2ZWxvcGVyJywgJ0V2YWx1YXRpb24nXQogICAgICAgIGRlZmF1bHQ6IERldmVsb3BlcgogICAg\
ICAgIHRpdGxlOiBTZXQgdGhlIFNRTCBTZXJ2ZXIgZWRpdGlvbi4KICAgICAgICBkaXNwbGF5X2dy\
b3VwOiBNUyBTUUwgQ29uZmlnCiAgICAgIC0gbmFtZTogTVNTUUxfUEFTU1dPUkQKICAgICAgICBy\
ZXF1aXJlZDogdHJ1ZQogICAgICAgIGRlZmF1bHQ6ICJIZWxsbzEyMyEiCiAgICAgICAgcGF0dGVy\
bjogIl4oPzooPzpbYS16XSsuKltBLVpdKy4qKFxcZHxcXFcpKy4qKVwKICAgICAgICAgIHwoPzpb\
QS1aXSsuKlthLXpdKy4qKFxcZHxcXFcpKy4qKVwKICAgICAgICAgIHwoPzooXFxkfFxcVykrLipb\
YS16XS4qW0EtWl0uKil8KD86KFxcZHxcXFcpKy4qW0EtWl0rLipbYS16XSsuKilcCiAgICAgICAg\
ICB8KD86W0EtWl0rLiooXFxkfFxcVykrLipbYS16XSsuKil8KD86W2Etel0rLiooXFxkfFxcVykr\
LipbQS1aXSsuKilcCiAgICAgICAgICB8KD86XFxkKy4qXFxXKy4qKFtBLVpdfFthLXpdKSsuKil8\
KD86XFxXKy4qXFxkKy4qKFtBLVpdfFthLXpdKSsuKilcCiAgICAgICAgICB8KD86KFtBLVpdfFth\
LXpdKSsuKlxcZCsuKlxcVysuKil8KD86KFtBLVpdfFthLXpdKSsuKlxcVysuKlxcZCsuKilcCiAg\
ICAgICAgICB8KD86XFxXKy4qKFtBLVpdfFthLXpdKSsuKlxcZCsuKil8KD86XFxkKy4qKFtBLVpd\
fFthLXpdKSsuKlxcVysuKikpJCIKICAgICAgICB0eXBlOiBzdHJpbmcKICAgICAgICBkaXNwbGF5\
X3R5cGU6IHBhc3N3b3JkCiAgICAgICAgdGl0bGU6ICJQYXNzd29yZCBmb3IgdGhlIGRhdGFiYXNl\
IGFkbWluIChTQSkgdXNlci4iCiAgICAgICAgZGVzY3JpcHRpb246CiAgICAgICAgICAiVGhlIHBh\
c3N3b3JkIG11c3QgYmUgYXQgbGVhc3QgOCBjaGFyYWN0ZXJzIGxvbmcgYW5kIGNvbnRhaW4KICAg\
ICAgICAgIGNoYXJhY3RlcnMgZnJvbSB0aHJlZSBvZiB0aGUgZm9sbG93aW5nIGZvdXIgc2V0czog\
VXBwZXJjYXNlCiAgICAgICAgICBsZXR0ZXJzLCBMb3dlcmNhc2UgbGV0dGVycywgQmFzZSAxMCBk\
aWdpdHMsIGFuZCBTeW1ib2xzLiIKICAgICAgICBkaXNwbGF5X2dyb3VwOiBNUyBTUUwgQ29uZmln\
CiAgICAgICAgbWluX2xlbmd0aDogOAogICAgICAgIG1heF9sZW5ndGg6IDEyOAogICAgICAtIG5h\
bWU6IE1TU1FMX0FHRU5UX0VOQUJMRUQKICAgICAgICB0aXRsZTogRW5hYmxlIFNRTCBTZXJ2ZXIg\
QWdlbnQuCiAgICAgICAgdHlwZTogYm9vbGVhbgogICAgICAgIHJlcXVpcmVkOiB0cnVlCiAgICAg\
ICAgZGVmYXVsdDogZmFsc2UKICAgICAgICBkZXNjcmlwdGlvbjogQnkgZGVmYXVsdCwgYWdlbnQg\
aXMgZGlzYWJsZWQuCiAgICAgICAgZGlzcGxheV9ncm91cDogTVMgU1FMIENvbmZpZwogICAgICAt\
IG5hbWU6IE1TU1FMX0xPQ0FMX0lTCiAgICAgICAgdGl0bGU6IFVzZSBleGlzdGluZyBtc3NxbC1z\
ZXJ2ZXItbGludXggaW1hZ2VzdHJlYW0gaW4gcHJvamVjdC4KICAgICAgICB0eXBlOiBib29sZWFu\
CiAgICAgICAgcmVxdWlyZWQ6IHRydWUKICAgICAgICBkZWZhdWx0OiBmYWxzZQogICAgICAgIGRp\
c3BsYXlfZ3JvdXA6IE1TIFNRTCBDb25maWcKICAgICAgLSBuYW1lOiBNU1NRTF9MQ0lECiAgICAg\
ICAgdGl0bGU6IFNldCB0aGUgbGFuZ3VhZ2UgSUQuCiAgICAgICAgdHlwZTogaW50ZWdlcgogICAg\
ICAgIHJlcXVpcmVkOiB0cnVlCiAgICAgICAgZGVmYXVsdDogMTAzMwogICAgICAgIGRlc2NyaXB0\
aW9uOiBGb3IgZXhhbXBsZSAtIDEwMzMgaXMgRW5nbGlzaCAoVVMpLCAxMDM2IGlzIEZyZW5jaC4K\
ICAgICAgICBtaW5fbGVuZ3RoOiA0CiAgICAgICAgbWF4X2xlbmd0aDogNAogICAgICAgIGRpc3Bs\
YXlfZ3JvdXA6IE1TIFNRTCBDb25maWcKICAgICAgLSBuYW1lOiBNU1NRTF9JTUFHRV9QVUxMCiAg\
ICAgICAgdGl0bGU6ICJEZXBsb3ltZW50Q29uZmlnIEltYWdlIHB1bGwgcG9saWN5IgogICAgICAg\
IHR5cGU6IGVudW0KICAgICAgICBlbnVtOiBbJ0Fsd2F5cycsICdJZk5vdFByZXNlbnQnLCAnTmV2\
ZXInXQogICAgICAgIHJlcXVpcmVkOiB0cnVlCiAgICAgICAgZGVmYXVsdDogSWZOb3RQcmVzZW50\
CiAgICAgICAgZGlzcGxheV9ncm91cDogTVMgU1FMIENvbmZpZwogICAgICAtIG5hbWU6IE1TU1FM\
X0RBVEFfU1RPUkFHRV9TSVpFCiAgICAgICAgcmVxdWlyZWQ6IHRydWUKICAgICAgICBkZWZhdWx0\
OiAxCiAgICAgICAgdHlwZTogaW50ZWdlcgogICAgICAgIHRpdGxlOiBQZXJzaXN0ZW50IHZvbHVt\
ZSBzaXplIGZvciBkYiBkYXRhIChpbiBHQikgZWcgMUdCIDJHQgogICAgICAgIGRpc3BsYXlfZ3Jv\
dXA6IEVudmlyb25tZW50IFNpemluZwogICAgICAtIG5hbWU6IE1TU1FMX01FTU9SWV9MSU1JVAog\
ICAgICAgIHJlcXVpcmVkOiB0cnVlCiAgICAgICAgZGVmYXVsdDogMwogICAgICAgIHR5cGU6IGlu\
dGVnZXIKICAgICAgICB0aXRsZToKICAgICAgICAgIE1heGltdW0gYW1vdW50IG9mIG1lbW9yeSB0\
aGUgY29udGFpbmVyIGNhbiB1c2UgKGluIEdCKSBlZyAxR0IgMkdCCiAgICAgICAgZGlzcGxheV9n\
cm91cDogRW52aXJvbm1lbnQgU2l6aW5nCiAgICAgIC0gbmFtZTogTVNTUUxfTUVNT1JZX1JFUVVF\
U1QKICAgICAgICByZXF1aXJlZDogdHJ1ZQogICAgICAgIGRlZmF1bHQ6IDIKICAgICAgICB0eXBl\
OiBpbnRlZ2VyCiAgICAgICAgdGl0bGU6CiAgICAgICAgICBSZXF1ZXN0ZWQgYW1vdW50IG9mIG1l\
bW9yeSBmb3IgdGhlIGNvbnRhaW5lciB0byBzdGFydCAoaW4gR0IpCiAgICAgICAgICBlZyAxR0Ig\
MkdCCiAgICAgICAgZGlzcGxheV9ncm91cDogRW52aXJvbm1lbnQgU2l6aW5nCg=="

COPY playbooks /opt/apb/actions
COPY roles /opt/ansible/roles
RUN chown -R apb:0 /opt/{ansible,apb} && \
    chmod -R g=u /opt/{ansible,apb}
USER apb
