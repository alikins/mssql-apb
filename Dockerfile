FROM ansibleplaybookbundle/apb-base

COPY playbooks /opt/apb/actions
COPY roles /opt/ansible/roles
RUN yum -y install --setopt=tsflags=nodocs python-pip && \
    pip install --upgrade pip && \
    pip install pymssql && \
    yum clean all && \
    chmod -R g=u /opt/{ansible,apb}
USER apb

LABEL "com.redhat.apb.spec"=\
"dmVyc2lvbjogMS4wCm5hbWU6IG1zc3FsLXNlcnZlci1hcGIKZGVzY3JpcHRpb246IEFQQiB0byBk\
ZXBsb3kgU1FMIFNlcnZlciBvbiBMaW51eApiaW5kYWJsZTogVHJ1ZQphc3luYzogb3B0aW9uYWwK\
bWV0YWRhdGE6CiAgZGlzcGxheU5hbWU6IFNRTCBTZXJ2ZXIgb24gTGludXggKEFQQikKICBpbWFn\
ZVVybDogaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL3RjaHVnaGVzaXYvbXNzcWwt\
c2VydmVyLWFwYi9kZXZlbC9kb2NzL2ltZy9zcWwtc2VydmVyLnBuZwogIGRvY3VtZW50YXRpb25V\
cmw6IGh0dHBzOi8vZG9jcy5taWNyb3NvZnQuY29tL2VuLXVzL3NxbC9saW51eC9zcWwtc2VydmVy\
LWxpbnV4LW92ZXJ2aWV3CiAgc2VydmljZU5hbWU6IG1zc3FsLXNlcnZlcgogIGRlcGVuZGVuY2ll\
czogWydkb2NrZXIuaW8vdGNodWdoZXNpdi9tc3NxbC1zZXJ2ZXItbGludXgnXQp0YWdzOgogIC0g\
ZGF0YWJhc2UKcGxhbnM6CiAgLSBuYW1lOiBlcGhlbWVyYWwKICAgIGRlc2NyaXB0aW9uOiBUaGlz\
IHBsYW4gZGVwbG95cyBhbiBlcGhlbWVyYWwgbXNzcWwtc2VydmVyLgogICAgZnJlZTogVHJ1ZQog\
ICAgZGVmYXVsdDogVHJ1ZQogICAgbWV0YWRhdGE6CiAgICAgIGRpc3BsYXlOYW1lOiBFcGhlbWVy\
YWwgaW5zdGFsbGF0aW9uCiAgICAgIGxvbmdEZXNjcmlwdGlvbjogVGhpcyBwbGFuIHdpbGwgZGVw\
bG95IGEgTVMgU1FMIFNlcnZlciBzdGFuZGFsb25lIHVzaW5nIGVwaGVtZXJhbCBzdG9yYWdlCiAg\
ICBwYXJhbWV0ZXJzOgogICAgICAtIG5hbWU6IE1TU1FMX1BBU1NXT1JECiAgICAgICAgcmVxdWly\
ZWQ6IFRydWUKICAgICAgICBkZWZhdWx0OiAieW91clN0cm9uZ0BQYXNzd29yZCIKICAgICAgICBw\
YXR0ZXJuOiAiXlthLXpBLVowLTlfLi1dKiQiCiAgICAgICAgdHlwZTogc3RyaW5nCiAgICAgICAg\
ZGlzcGxheV90eXBlOiBwYXNzd29yZAogICAgICAgIHRpdGxlOiAiUGFzc3dvcmQgZm9yIHRoZSBk\
YXRhYmFzZSBhZG1pbiB1c2VyLiIKICAgICAgICBkZXNjcmlwdGlvbjogIlRoZSBwYXNzd29yZCBz\
aG91bGQgZm9sbG93IHRoZSBTUUwgU2VydmVyIGRlZmF1bHQgcGFzc3dvcmQgcG9saWN5LCBvdGhl\
cndpc2UgdGhlIGNvbnRhaW5lciBjYW4gbm90IHNldHVwIFNRTCBzZXJ2ZXIgYW5kIHdpbGwgc3Rv\
cCB3b3JraW5nLiBCeSBkZWZhdWx0LCB0aGUgcGFzc3dvcmQgbXVzdCBiZSBhdCBsZWFzdCA4IGNo\
YXJhY3RlcnMgbG9uZyBhbmQgY29udGFpbiBjaGFyYWN0ZXJzIGZyb20gdGhyZWUgb2YgdGhlIGZv\
bGxvd2luZyBmb3VyIHNldHM6IFVwcGVyY2FzZSBsZXR0ZXJzLCBMb3dlcmNhc2UgbGV0dGVycywg\
QmFzZSAxMCBkaWdpdHMsIGFuZCBTeW1ib2xzLiBZb3UgY2FuIGV4YW1pbmUgdGhlIGVycm9yIGxv\
ZyBieSBleGVjdXRpbmcgdGhlIGRvY2tlciBsb2dzIGNvbW1hbmQuIgogICAgICAgIGRpc3BsYXlf\
Z3JvdXA6IE1TIFNRTCBDb25maWcKICAgICAgLSBuYW1lOiBNU1NRTF9EQVRBQkFTRQogICAgICAg\
IHJlcXVpcmVkOiBUcnVlCiAgICAgICAgZGVmYXVsdDogc2FtcGxlZGIKICAgICAgICBwYXR0ZXJu\
OiAiXlthLXpBLVowLTlfLV0qJCIKICAgICAgICB0eXBlOiBzdHJpbmcKICAgICAgICB0aXRsZTog\
TmFtZSBvZiB0aGUgTVMgU1FMIGRhdGFiYXNlIGFjY2Vzc2VkCiAgICAgICAgZGlzcGxheV9ncm91\
cDogTVMgU1FMIENvbmZpZwogICAgICAtIG5hbWU6IE1TU1FMX01FTU9SWV9MSU1JVAogICAgICAg\
IGRlZmF1bHQ6IDJHaQogICAgICAgIHR5cGU6IHN0cmluZwogICAgICAgIHRpdGxlOiBNYXhpbXVt\
IGFtb3VudCBvZiBtZW1vcnkgdGhlIGNvbnRhaW5lciBjYW4gdXNlIGVnIDUxMk1pIDFHaQogICAg\
ICAgIGRpc3BsYXlfZ3JvdXA6IEVudmlyb25tZW50IFNpemluZwogICAgICAtIG5hbWU6IE1TU1FM\
X01FTU9SWV9SRVFVRVNUCiAgICAgICAgZGVmYXVsdDogMUdpCiAgICAgICAgdHlwZTogc3RyaW5n\
CiAgICAgICAgdGl0bGU6IFJlcXVlc3RlZCBhbW91bnQgb2YgbWVtb3J5IGZvciB0aGUgY29udGFp\
bmVyIHRvIHN0YXJ0IGVnIDFHaSAyR2kKICAgICAgICBkaXNwbGF5X2dyb3VwOiBFbnZpcm9ubWVu\
dCBTaXppbmcK"
