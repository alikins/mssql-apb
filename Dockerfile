FROM ansibleplaybookbundle/apb-base

LABEL "com.redhat.apb.spec"=\
"LS0tCnZlcnNpb246IDEuMApuYW1lOiBtc3NxbC1hcGIKZGVzY3JpcHRpb246IEFQQiB0byBkZXBs\
b3kgTWljcm9zb2Z0IFNRTCBTZXJ2ZXIgb24gTGludXggMjAxNwpiaW5kYWJsZTogdHJ1ZQphc3lu\
Yzogb3B0aW9uYWwKbWV0YWRhdGE6CiAgZGlzcGxheU5hbWU6IE1TIFNRTCBTZXJ2ZXIgb24gTGlu\
dXggKEFQQikKICBpbWFnZVVybDoKICAgIGh0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNv\
bS9hbnNpYmxlcGxheWJvb2tidW5kbGUvbXNzcWwtYXBiL21hc3Rlci9kb2NzL2ltZy9zcWwtc2Vy\
dmVyLnBuZwogIGRvY3VtZW50YXRpb25Vcmw6CiAgICBodHRwczovL2RvY3MubWljcm9zb2Z0LmNv\
bS9lbi11cy9zcWwvbGludXgvc3FsLXNlcnZlci1saW51eC1vdmVydmlldwogIGRlcGVuZGVuY2ll\
czogWydkb2NrZXIuaW8vdGNodWdoZXNpdi9tc3NxbC1zZXJ2ZXItbGludXgnXQp0YWdzOgogIC0g\
ZGF0YWJhc2UKICAtIG1zc3FsCnBsYW5zOgogIC0gbmFtZTogZXBoZW1lcmFsCiAgICBkZXNjcmlw\
dGlvbjogVGhpcyBwbGFuIGRlcGxveXMgYW4gZXBoZW1lcmFsIE1TIFNRTCBTZXJ2ZXIuCiAgICBm\
cmVlOiB0cnVlCiAgICBkZWZhdWx0OiB0cnVlCiAgICBtZXRhZGF0YToKICAgICAgZGlzcGxheU5h\
bWU6IEVwaGVtZXJhbCBpbnN0YWxsYXRpb24KICAgICAgbG9uZ0Rlc2NyaXB0aW9uOgogICAgICAg\
IFRoaXMgcGxhbiB3aWxsIGRlcGxveSBhIHN0YW5kYWxvbmUgTVMgU1FMIFNlcnZlciBvbiBMaW51\
eAogICAgICAgIHVzaW5nIGVwaGVtZXJhbCBzdG9yYWdlCiAgICBwYXJhbWV0ZXJzOgogICAgICAt\
IG5hbWU6IE1TU1FMX1BBU1NXT1JECiAgICAgICAgcmVxdWlyZWQ6IHRydWUKICAgICAgICBkZWZh\
dWx0OiAiSGVsbG8xMjMhIgogICAgICAgIHBhdHRlcm46ICJeKD86KD86W2Etel0rLipbQS1aXSsu\
KihcXGR8XFxXKSsuKilcCiAgICAgICAgICB8KD86W0EtWl0rLipbYS16XSsuKihcXGR8XFxXKSsu\
KilcCiAgICAgICAgICB8KD86KFxcZHxcXFcpKy4qW2Etel0uKltBLVpdLiopfCg/OihcXGR8XFxX\
KSsuKltBLVpdKy4qW2Etel0rLiopXAogICAgICAgICAgfCg/OltBLVpdKy4qKFxcZHxcXFcpKy4q\
W2Etel0rLiopfCg/OlthLXpdKy4qKFxcZHxcXFcpKy4qW0EtWl0rLiopXAogICAgICAgICAgfCg/\
OlxcZCsuKlxcVysuKihbQS1aXXxbYS16XSkrLiopfCg/OlxcVysuKlxcZCsuKihbQS1aXXxbYS16\
XSkrLiopXAogICAgICAgICAgfCg/OihbQS1aXXxbYS16XSkrLipcXGQrLipcXFcrLiopfCg/Oihb\
QS1aXXxbYS16XSkrLipcXFcrLipcXGQrLiopXAogICAgICAgICAgfCg/OlxcVysuKihbQS1aXXxb\
YS16XSkrLipcXGQrLiopfCg/OlxcZCsuKihbQS1aXXxbYS16XSkrLipcXFcrLiopKSQiCiAgICAg\
ICAgdHlwZTogc3RyaW5nCiAgICAgICAgZGlzcGxheV90eXBlOiBwYXNzd29yZAogICAgICAgIHRp\
dGxlOiAiUGFzc3dvcmQgZm9yIHRoZSBkYXRhYmFzZSBhZG1pbiAoU0EpIHVzZXIuIgogICAgICAg\
IGRlc2NyaXB0aW9uOgogICAgICAgICAgIlRoZSBwYXNzd29yZCBtdXN0IGJlIGF0IGxlYXN0IDgg\
Y2hhcmFjdGVycyBsb25nIGFuZCBjb250YWluCiAgICAgICAgICBjaGFyYWN0ZXJzIGZyb20gdGhy\
ZWUgb2YgdGhlIGZvbGxvd2luZyBmb3VyIHNldHM6IFVwcGVyY2FzZQogICAgICAgICAgbGV0dGVy\
cywgTG93ZXJjYXNlIGxldHRlcnMsIEJhc2UgMTAgZGlnaXRzLCBhbmQgU3ltYm9scy4iCiAgICAg\
ICAgZGlzcGxheV9ncm91cDogTVMgU1FMIENvbmZpZwogICAgICAgIG1pbl9sZW5ndGg6IDgKICAg\
ICAgICBtYXhfbGVuZ3RoOiAxMjgKICAgICAgLSBuYW1lOiBNU1NRTF9EQVRBQkFTRQogICAgICAg\
IHJlcXVpcmVkOiB0cnVlCiAgICAgICAgZGVmYXVsdDogVGVzdERCCiAgICAgICAgcGF0dGVybjog\
Il5bYS16QS1aMC05Xy1dKiQiCiAgICAgICAgdHlwZTogc3RyaW5nCiAgICAgICAgdGl0bGU6IE5h\
bWUgb2YgdGhlIE1TIFNRTCBkYXRhYmFzZSB0byBjcmVhdGUuCiAgICAgICAgZGlzcGxheV9ncm91\
cDogTVMgU1FMIENvbmZpZwogICAgICAtIG5hbWU6IE1TU1FMX1BJRAogICAgICAgIHJlcXVpcmVk\
OiB0cnVlCiAgICAgICAgdHlwZTogZW51bQogICAgICAgIGVudW06IFsnRXZhbHVhdGlvbicsICdE\
ZXZlbG9wZXInLCAnRXhwcmVzcyddCiAgICAgICAgZGVmYXVsdDogRGV2ZWxvcGVyCiAgICAgICAg\
dGl0bGU6IFNldCB0aGUgU1FMIFNlcnZlciBlZGl0aW9uLgogICAgICAgIGRpc3BsYXlfZ3JvdXA6\
IE1TIFNRTCBDb25maWcKICAgICAgLSBuYW1lOiBNU1NRTF9BR0VOVF9FTkFCTEVECiAgICAgICAg\
dGl0bGU6IEVuYWJsZSBTUUwgU2VydmVyIEFnZW50LgogICAgICAgIHR5cGU6IGJvb2xlYW4KICAg\
ICAgICByZXF1aXJlZDogdHJ1ZQogICAgICAgIGRlZmF1bHQ6IGZhbHNlCiAgICAgICAgZGVzY3Jp\
cHRpb246IEJ5IGRlZmF1bHQsIGFnZW50IGlzIGRpc2FibGVkLgogICAgICAgIGRpc3BsYXlfZ3Jv\
dXA6IE1TIFNRTCBDb25maWcKICAgICAgLSBuYW1lOiBNU1NRTF9MQ0lECiAgICAgICAgdGl0bGU6\
IFNldCB0aGUgbGFuZ3VhZ2UgSUQuCiAgICAgICAgdHlwZTogaW50ZWdlcgogICAgICAgIHJlcXVp\
cmVkOiB0cnVlCiAgICAgICAgZGVmYXVsdDogMTAzMwogICAgICAgIGRlc2NyaXB0aW9uOiBGb3Ig\
ZXhhbXBsZSAtIDEwMzMgaXMgRW5nbGlzaCAoVVMpLCAxMDM2IGlzIEZyZW5jaC4KICAgICAgICBt\
aW5fbGVuZ3RoOiA0CiAgICAgICAgbWF4X2xlbmd0aDogNAogICAgICAgIGRpc3BsYXlfZ3JvdXA6\
IE1TIFNRTCBDb25maWcKICAgICAgLSBuYW1lOiBNU1NRTF9JTUFHRV9QVUxMCiAgICAgICAgdGl0\
bGU6ICJEZXBsb3ltZW50Q29uZmlnIEltYWdlIHB1bGwgcG9saWN5IgogICAgICAgIHR5cGU6IGVu\
dW0KICAgICAgICBlbnVtOiBbJ0Fsd2F5cycsICdJZk5vdFByZXNlbnQnLCAnTmV2ZXInXQogICAg\
ICAgIHJlcXVpcmVkOiB0cnVlCiAgICAgICAgZGVmYXVsdDogQWx3YXlzCiAgICAgICAgZGlzcGxh\
eV9ncm91cDogTVMgU1FMIENvbmZpZwogICAgICAtIG5hbWU6IE1TU1FMX01FTU9SWV9MSU1JVAog\
ICAgICAgIHJlcXVpcmVkOiB0cnVlCiAgICAgICAgZGVmYXVsdDogMwogICAgICAgIHR5cGU6IGlu\
dGVnZXIKICAgICAgICB0aXRsZToKICAgICAgICAgIE1heGltdW0gYW1vdW50IG9mIG1lbW9yeSB0\
aGUgY29udGFpbmVyIGNhbiB1c2UgKGluIEdCKSBlZyAxR0IgMkdCCiAgICAgICAgZGlzcGxheV9n\
cm91cDogRW52aXJvbm1lbnQgU2l6aW5nCiAgICAgIC0gbmFtZTogTVNTUUxfTUVNT1JZX1JFUVVF\
U1QKICAgICAgICByZXF1aXJlZDogdHJ1ZQogICAgICAgIGRlZmF1bHQ6IDIKICAgICAgICB0eXBl\
OiBpbnRlZ2VyCiAgICAgICAgdGl0bGU6CiAgICAgICAgICBSZXF1ZXN0ZWQgYW1vdW50IG9mIG1l\
bW9yeSBmb3IgdGhlIGNvbnRhaW5lciB0byBzdGFydCAoaW4gR0IpCiAgICAgICAgICBlZyAxR0Ig\
MkdCCiAgICAgICAgZGlzcGxheV9ncm91cDogRW52aXJvbm1lbnQgU2l6aW5nCgogIC0gbmFtZTog\
cGVyc2lzdGVudAogICAgZGVzY3JpcHRpb246IFRoaXMgcGxhbiBkZXBsb3lzIGEgcGVyc2lzdGVu\
dCBNUyBTUUwgU2VydmVyLgogICAgZnJlZTogdHJ1ZQogICAgbWV0YWRhdGE6CiAgICAgIGRpc3Bs\
YXlOYW1lOiBQZXJzaXN0ZW50IGluc3RhbGxhdGlvbgogICAgICBsb25nRGVzY3JpcHRpb246CiAg\
ICAgICAgVGhpcyBwbGFuIHdpbGwgZGVwbG95IGEgc3RhbmRhbG9uZSBNUyBTUUwgU2VydmVyIG9u\
IExpbnV4CiAgICAgICAgdXNpbmcgcGVyc2lzdGVudCBzdG9yYWdlCiAgICBwYXJhbWV0ZXJzOgog\
ICAgICAtIG5hbWU6IE1TU1FMX1BBU1NXT1JECiAgICAgICAgcmVxdWlyZWQ6IHRydWUKICAgICAg\
ICBkZWZhdWx0OiAiSGVsbG8xMjMhIgogICAgICAgIHBhdHRlcm46ICJeKD86KD86W2Etel0rLipb\
QS1aXSsuKihcXGR8XFxXKSsuKilcCiAgICAgICAgICB8KD86W0EtWl0rLipbYS16XSsuKihcXGR8\
XFxXKSsuKilcCiAgICAgICAgICB8KD86KFxcZHxcXFcpKy4qW2Etel0uKltBLVpdLiopfCg/Oihc\
XGR8XFxXKSsuKltBLVpdKy4qW2Etel0rLiopXAogICAgICAgICAgfCg/OltBLVpdKy4qKFxcZHxc\
XFcpKy4qW2Etel0rLiopfCg/OlthLXpdKy4qKFxcZHxcXFcpKy4qW0EtWl0rLiopXAogICAgICAg\
ICAgfCg/OlxcZCsuKlxcVysuKihbQS1aXXxbYS16XSkrLiopfCg/OlxcVysuKlxcZCsuKihbQS1a\
XXxbYS16XSkrLiopXAogICAgICAgICAgfCg/OihbQS1aXXxbYS16XSkrLipcXGQrLipcXFcrLiop\
fCg/OihbQS1aXXxbYS16XSkrLipcXFcrLipcXGQrLiopXAogICAgICAgICAgfCg/OlxcVysuKihb\
QS1aXXxbYS16XSkrLipcXGQrLiopfCg/OlxcZCsuKihbQS1aXXxbYS16XSkrLipcXFcrLiopKSQi\
CiAgICAgICAgdHlwZTogc3RyaW5nCiAgICAgICAgZGlzcGxheV90eXBlOiBwYXNzd29yZAogICAg\
ICAgIHRpdGxlOiAiUGFzc3dvcmQgZm9yIHRoZSBkYXRhYmFzZSBhZG1pbiAoU0EpIHVzZXIuIgog\
ICAgICAgIGRlc2NyaXB0aW9uOgogICAgICAgICAgIlRoZSBwYXNzd29yZCBtdXN0IGJlIGF0IGxl\
YXN0IDggY2hhcmFjdGVycyBsb25nIGFuZCBjb250YWluCiAgICAgICAgICBjaGFyYWN0ZXJzIGZy\
b20gdGhyZWUgb2YgdGhlIGZvbGxvd2luZyBmb3VyIHNldHM6IFVwcGVyY2FzZQogICAgICAgICAg\
bGV0dGVycywgTG93ZXJjYXNlIGxldHRlcnMsIEJhc2UgMTAgZGlnaXRzLCBhbmQgU3ltYm9scy4i\
CiAgICAgICAgZGlzcGxheV9ncm91cDogTVMgU1FMIENvbmZpZwogICAgICAgIG1pbl9sZW5ndGg6\
IDgKICAgICAgICBtYXhfbGVuZ3RoOiAxMjgKICAgICAgLSBuYW1lOiBNU1NRTF9EQVRBQkFTRQog\
ICAgICAgIHJlcXVpcmVkOiB0cnVlCiAgICAgICAgZGVmYXVsdDogVGVzdERCCiAgICAgICAgcGF0\
dGVybjogIl5bYS16QS1aMC05Xy1dKiQiCiAgICAgICAgdHlwZTogc3RyaW5nCiAgICAgICAgdGl0\
bGU6IE5hbWUgb2YgdGhlIE1TIFNRTCBkYXRhYmFzZSB0byBjcmVhdGUuCiAgICAgICAgZGlzcGxh\
eV9ncm91cDogTVMgU1FMIENvbmZpZwogICAgICAtIG5hbWU6IE1TU1FMX1BJRAogICAgICAgIHJl\
cXVpcmVkOiB0cnVlCiAgICAgICAgdHlwZTogZW51bQogICAgICAgIGVudW06IFsnRXZhbHVhdGlv\
bicsICdEZXZlbG9wZXInLCAnRXhwcmVzcyddCiAgICAgICAgZGVmYXVsdDogRGV2ZWxvcGVyCiAg\
ICAgICAgdGl0bGU6IFNldCB0aGUgU1FMIFNlcnZlciBlZGl0aW9uLgogICAgICAgIGRpc3BsYXlf\
Z3JvdXA6IE1TIFNRTCBDb25maWcKICAgICAgLSBuYW1lOiBNU1NRTF9BR0VOVF9FTkFCTEVECiAg\
ICAgICAgdGl0bGU6IEVuYWJsZSBTUUwgU2VydmVyIEFnZW50LgogICAgICAgIHR5cGU6IGJvb2xl\
YW4KICAgICAgICByZXF1aXJlZDogdHJ1ZQogICAgICAgIGRlZmF1bHQ6IGZhbHNlCiAgICAgICAg\
ZGVzY3JpcHRpb246IEJ5IGRlZmF1bHQsIGFnZW50IGlzIGRpc2FibGVkLgogICAgICAgIGRpc3Bs\
YXlfZ3JvdXA6IE1TIFNRTCBDb25maWcKICAgICAgLSBuYW1lOiBNU1NRTF9MQ0lECiAgICAgICAg\
dGl0bGU6IFNldCB0aGUgbGFuZ3VhZ2UgSUQuCiAgICAgICAgdHlwZTogaW50ZWdlcgogICAgICAg\
IHJlcXVpcmVkOiB0cnVlCiAgICAgICAgZGVmYXVsdDogMTAzMwogICAgICAgIGRlc2NyaXB0aW9u\
OiBGb3IgZXhhbXBsZSAtIDEwMzMgaXMgRW5nbGlzaCAoVVMpLCAxMDM2IGlzIEZyZW5jaC4KICAg\
ICAgICBtaW5fbGVuZ3RoOiA0CiAgICAgICAgbWF4X2xlbmd0aDogNAogICAgICAgIGRpc3BsYXlf\
Z3JvdXA6IE1TIFNRTCBDb25maWcKICAgICAgLSBuYW1lOiBNU1NRTF9JTUFHRV9QVUxMCiAgICAg\
ICAgdGl0bGU6ICJEZXBsb3ltZW50Q29uZmlnIEltYWdlIHB1bGwgcG9saWN5IgogICAgICAgIHR5\
cGU6IGVudW0KICAgICAgICBlbnVtOiBbJ0Fsd2F5cycsICdJZk5vdFByZXNlbnQnLCAnTmV2ZXIn\
XQogICAgICAgIHJlcXVpcmVkOiB0cnVlCiAgICAgICAgZGVmYXVsdDogQWx3YXlzCiAgICAgICAg\
ZGlzcGxheV9ncm91cDogTVMgU1FMIENvbmZpZwogICAgICAtIG5hbWU6IE1TU1FMX0RBVEFfU1RP\
UkFHRV9TSVpFCiAgICAgICAgcmVxdWlyZWQ6IHRydWUKICAgICAgICBkZWZhdWx0OiAxCiAgICAg\
ICAgdHlwZTogaW50ZWdlcgogICAgICAgIHRpdGxlOiBQZXJzaXN0ZW50IHZvbHVtZSBzaXplIGZv\
ciBkYiBkYXRhIChpbiBHQikgZWcgMUdCIDJHQgogICAgICAgIGRpc3BsYXlfZ3JvdXA6IEVudmly\
b25tZW50IFNpemluZwogICAgICAtIG5hbWU6IE1TU1FMX01FTU9SWV9MSU1JVAogICAgICAgIHJl\
cXVpcmVkOiB0cnVlCiAgICAgICAgZGVmYXVsdDogMwogICAgICAgIHR5cGU6IGludGVnZXIKICAg\
ICAgICB0aXRsZToKICAgICAgICAgIE1heGltdW0gYW1vdW50IG9mIG1lbW9yeSB0aGUgY29udGFp\
bmVyIGNhbiB1c2UgKGluIEdCKSBlZyAxR0IgMkdCCiAgICAgICAgZGlzcGxheV9ncm91cDogRW52\
aXJvbm1lbnQgU2l6aW5nCiAgICAgIC0gbmFtZTogTVNTUUxfTUVNT1JZX1JFUVVFU1QKICAgICAg\
ICByZXF1aXJlZDogdHJ1ZQogICAgICAgIGRlZmF1bHQ6IDIKICAgICAgICB0eXBlOiBpbnRlZ2Vy\
CiAgICAgICAgdGl0bGU6CiAgICAgICAgICBSZXF1ZXN0ZWQgYW1vdW50IG9mIG1lbW9yeSBmb3Ig\
dGhlIGNvbnRhaW5lciB0byBzdGFydCAoaW4gR0IpCiAgICAgICAgICBlZyAxR0IgMkdCCiAgICAg\
ICAgZGlzcGxheV9ncm91cDogRW52aXJvbm1lbnQgU2l6aW5nCg=="

COPY playbooks /opt/apb/actions
COPY roles /opt/ansible/roles
RUN chown -R apb:0 /opt/{ansible,apb} && \
    chmod -R g=u /opt/{ansible,apb}
USER apb
